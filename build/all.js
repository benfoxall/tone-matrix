function boxLayout(){function t(t){if(n=t||n){var d=d3.max(n.map(e("i"))),s=d3.max(n.map(e("j")));console.log(d,s),u.domain([0,d+1]).range([0,i]),c.domain([0,s+1]).range([0,o]);var f=u(1),l=c(1);n.forEach(function(t){t.width=f*(1-a),t.height=l*(1-a),t.x=u(t.i)+f*a*.5,t.y=c(t.j)+l*a*.5}),r(n)}}function e(t){return function(e){return e[t]}}var n,i=400,o=400,a=.2,r=function(){},u=d3.scale.linear(),c=d3.scale.linear();return t.update=function(t){return"undefined"==typeof t?r:(r=t,this)},t.width=function(t){return"undefined"==typeof t?i:(i=t,this)},t.height=function(t){return"undefined"==typeof t?o:(o=t,this)},t.padding=function(t){return"undefined"==typeof t?a:(a=t,this)},t}function Note(t,e){this.i=t,this.j=e}function now(){return Date.now()}function schedule(){var t=1e3*duration-now()%(1e3*duration);notes.forEach(function(e,n){if(e.active){var i=1200-100*e.j,o=timescale(e.i)+t/1e3;play(i,o),setTimeout(function(){item[0][n].className="item playing",setTimeout(function(){item[0][n].className=e.active?"item active":"item"},500)},1e3*o)}})}function play(t,e){var n=context.currentTime+(e||0),i=context.createOscillator();i.frequency.value=t;var o=context.createGain();o.gain.value=0,o.gain.exponentialRampToValueAtTime(.01,n+.2),o.gain.linearRampToValueAtTime(0,n+.5),i.connect(o),o.connect(context.destination),i.start(n),i.stop(n+1)}function fitWindow(){b.width(window.innerWidth),b.height(window.innerHeight),b()}var el=d3.select("body").append("div").attr("class","grid"),b=boxLayout().width(window.innerWidth).height(window.innerHeight);Note.prototype.handle=function(){this.active=!this.active,item.attr("class",function(t){return t.active?"item active":"item"})};for(var timesteps=16,notes=[],i=0;timesteps>i;i++)for(var j=0;10>j;j++)notes.push(new Note(i,j));var item=el.selectAll(".item").data(notes);b.update(function(t){function e(t){t.handle&&t.handle()}item=item.data(t),item.enter().append("div").style("width",0).style("height",0).attr("class","item").on("touchstart",e).on("mousedown",e),item.exit().transition().style("width",0).remove(),item.style("transform",function(t){return"translate("+t.x+"px, "+t.y+"px)"}).style("width",function(t){return t.width+"px"}).style("height",function(t){return t.height+"px"})}),b(notes);var duration=2,timescale=d3.scale.linear().domain([0,timesteps]).range([0,duration]);setInterval(schedule,1e3*duration),context="undefined"!=typeof webkitAudioContext?new webkitAudioContext:new AudioContext,notes.reduce(function(t,e){return t.indexOf(e.i+"_"+e.j)>-1&&(e.active=!0),t},["0_3","4_4","8_5","10_6","12_7","14_9"]),fitWindow(),d3.select(window).on("resize",fitWindow);
//# sourceMappingURL=all.js.map